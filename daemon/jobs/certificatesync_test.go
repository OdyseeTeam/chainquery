package jobs

import (
	"testing"

	"github.com/lbryio/chainquery/global"
	"github.com/lbryio/lbryschema.go/claim"
)

type claimCertTest struct {
	signedClaimHex     string
	signedClaimAddress string
	certClaimHex       string
	certClaimID        string
}

var pass = []claimCertTest{
	{
		"080110011a8a28080112c227080410011a4f4a6f617175c3ad6e20506978c3a16e202d2043686520646963692c206f68207061726f6c612064656c2073616767696f20284c69766520636f6e63657274204f72746f6e6120323030372920322f382286264c69766520636f6e6365727420497374697475746f204e617a696f6e616c6520546f737469616e6f20284f72746f6e6120323030372920322f38200a436f6d706f7365722c204672616e636573636f2050616f6c6f20546f7374692e200a4c797269636973742c204761627269656c65204427416e6e756e7a696f2e200a4a6f617175c3ad6e20506978c3a16e2c2074656e6f722e200a47696f76616e6e692041756c657474612c207069616e6f2e200a0a54686520636174616c6f67206f66206368616d62657220766f63616c20776f726b73206f6620536972204672616e636573636f2050616f6c6f20546f73746920284f72746f6e612c2031383436202d20526f6d652c203139313629206f666665727320616e20696e6578686175737469626c6520736f75726365206f662073656c656374696f6e2c20616c77617973206f726967696e616c2c20626f746820666f72206c69766520706572666f726d616e63657320616e642074686520646973636f6772617068792e20546865206e756d626572206f6620726f6d616e7a61732c206368616e736f6e7320616e6420736f6e67732c20776869636820616c72656164792077617320636c6f736520746f20343030207469746c657320616e642077686963682068617320726563656e746c79206265656e206675727468657220656e7269636865642077697468206e657720646973636f7665726965732c2070757473204974616c69616e206d7573696369616e20616d6f6e6720746865206d6f73742070726f6c69666963206f662074686174206b696e64206f66206c6976696e6720726f6f6d207468617420776173207468652070696c6c6172206f6620736f756e6420696e206576657279646179206c69666520696e20746865204575726f7065206f66207468652042656c6c6520c389706f7175652e2049742069732074727565207468617420746865207265636f7264696e6720696e74657265737420686173206265656e20696e6372656173696e6720696e20726563656e7420796561727320707265636973656c7920627920746865207265646973636f7665727920616e642064697373656d696e6174696f6e206f66206d616e79207469746c65732074686174207765726520756e6b6e6f776e206f72207765726520666f72676f7474656e2c206275742074686174206172652070726f76696e67206e6f7468696e67206c657373207468616e2074686f73652022686973746f726963616c2220726f6d616e7a6173207468617420666f722064656361646573206861642073617475726174656420612072657065617465646c7920626f746820636f6e636572742070726f6772616d7320616e64207265636f72642065646974696f6e732e205468657265206973206e6f20646f75627420746861742c20696e20636f6e6e656374696f6e2077697468207468652070726f64756374696f6e206f6620546f7374692c20636f6e7374697475746573206120706172746963756c6172206d65726974206f662074656e6f72204a6f617175c3ad6e20506978c3a16e207468652073656172636820666f722070616765732074686174206861766520616c6c6f77656420697420746f20616368696576652c2077697468207468697320646973632c207265636f7264696e67206f66206d6f7265207468616e20666f72747920726f6d616e7a617320616e6420676174686572206669766520636f6d706f736974696f6e73206162736f6c7574656c7920756e6865617264206f6620666f722076696f6c696e20616e64207069616e6f20616e6420666f7220736f6c6f207069616e6f206f6620636f6d706f73657220416272757a7a6f2e20546875732c2074686520696e7465726573742c20776869636820776520636f756c642063616c6c2077697468206c6f76652c2061727469737469632070726f7065727479205370616e6973682074656e6f7220627920746865206d75736963206f6620462e502e20546f7374692068617320726573756c74656420696e20616e20616e74686f6c6f6779206f6620746865206e756d65726f7573207469746c65732c20636f6d62696e696e672074686520616c7761797320726566696e656420696e746572707265746174696f6e732077697468206120726573656172636820776f726b20616e642061206e6f76656c2070726f706f73616c2074686579206861766520676976656e20746f207468652064697373656d696e6174696f6e206f662074686520546f737469616e20776f726b20612073657276696365206d6f7265207468616e207369676e69666963616e742e205468657265666f72652c206173206469726563746f72206f662074686520497374697475746f204e617a696f6e616c6520546f737469616e6f2c2049206163636570746564207769746820706c65617375726520746f2070726573656e742074686973206e657720656e646561766f7220616c62756d204a6f617175c3ad6e20506978c3a16e2c20776869636820696e2070617274732063686f73656e2072657475726e7320746f2077616c6b20776974682067726561742063617265206d616e79207061746873206f6620636f6d706f736974696f6e616c20546f7374692c20706179696e67207370656369616c20617474656e74696f6e20746f20746865206c65617374206b6e6f776e20706167657320616e6420696e7465727072657465642e20200a546865206469736b207468617420746865206c697374656e6572206e6f772068617320696e206974732068616e647320697320746865206672756974206f6620612064696c6967656e7420776f726b2061732066657720616e64207768696368206265617273207769746e65737320746f2074686520497374697475746f204e617a696f6e616c6520546f737469616e6f20746861742c20666f722069747320706172742c2068617320636f6f706572617465642077697468207468652073616d652064656469636174696f6e20616e642077697468207468652073616d6520656e746875736961736d207468617420686164206265656e206465766f74656420746f20697473207265616c697a6174696f6e204a6f617175c3ad6e20506978c3a16e20616e642069747320617274697374696320616e6420746563686e6963616c20706172746e6572732e20200a54686520667261676d656e7473207265636f7264656420636f766572207669727475616c6c792074686520656e7469726520726f757465206f662074686520636f6d706f736974696f6e616c206163746976697479206f6620546f7374692c2066726f6d20313837362028536572656e6174612064276120416e67656c6f2920746f20313931352028416e696d61206d6961292e205468652073656c656374696f6e20686173206265656e206d616465207370656369666963616c6c7920666f7220746865204974616c69616e2070726f64756374696f6e2c207769746820726f6d616e7a61732077686f73652076657273657320636f6e737469747574652061206b696e64206f6620616e74686f6c6f6779206f6620746865204974616c69616e20706f65747279206f66207472616e736974206265747765656e20746865206e696e657465656e746820616e64207477656e74696574682063656e7475726965732c207769746820706f6574696320636f6d706f736974696f6e73206265666f726520616c6c206f66204427416e6e756e7a696f2c2062757420616c736f206f66205061676c696172612c204769757374692c2050616e7a61636368692c2043696d6d696e6f2c205072616775652c20537465636368657474692c20466f6e74616e613a20777269746572732c20706f6574732c206c696272657474697374732c206a6f75726e616c697374732c20696e74656c6c65637475616c732077686f20656e636f75726167656420746865204974616c69616e2063756c747572616c206c696665206f662074686f736520796561727320616e642077686f20546f7374692c20686176696e672066616c6c656e20736f6d65206f66207468656d20756e6a7573746c7920696e206f626c6976696f6e2c206c656420746f2074686520696d6d6f7274616c697479207769746820796f7572206d757369632e20200a5468652073656c656374696f6e20616e6420746865206f72646572206f662074686520667261676d656e747320617265207468652064656d6f6e7374726174696f6e73206f662074686973207374756479206f6e207468652077686f6c6520636f72707573206f66204974616c69616e20726f6d616e7a617320546f7374692c207768696368206d616b65732074686973206469736b206f6e65206f66207468652074726962757465732064656570657220616e64206d6f7265207761797320746f204672616e636573636f2050616f6c6f20546f7374692e2054686520696e74657270726574617469766520636f6465206973207269676f726f757320776974682072656761726420746f207265737065637420666f7220746865206f726967696e616c20746f737469616e2c20616e64207375636820686173206265656e2074686520726571756972656d656e7420746f2073696e6720746f20546f73746920617320546f73746920686173207772697474656e202866696e616c6c792129207468617420506978c3a16e2c20736f206173206e6f7420746f206162616e646f6e206869732074656e6f7220226e6174757265222c2062757420616c776179732072657370656374696e672074686520746f737469616e2072656164696e672c206861732061646465642074776f2076657273696f6e732022617262697472617279222c2077697468206163757465206e6f74207772697474656e2c204c27756c74696d612063616e7a6f6e6520616e6420416464696f202866726f6d2074686520456e676c697368204f726967696e616c20476f6f6420427965292c206120636f7272656374696f6e207468617420646573657276657320746865206170706c61757365206f6620616c6c2e20200a4e65787420746f2074686520726f6d616e7a6173206170706561722066697665206368616d6265722070617274732e204f6e65206f66207468656d2069732077656c6c206b6e6f776e2066726f6d2074686520706f696e74206f662076696577206f6620696e746572707265746174696f6e2c2062757420756e7075626c697368656420696e20616e20616c62756d207965743a20746865207069616e6f2076657273696f6e2c206d61646520627920746865206f776e20546f7374692c206f662074686520736f6e6720666f72206576657220616e6420666f7220657665722057616c7a657220666f72207069616e6f206f6e20462e502e20546f7374692063656c6562726174656420736f6e672e20546865206f7468657220666f7572206172652074776f2070696563657320666f722076696f6c696e20616e64207069616e6f2c20496e71756965747564696e6520616e6420726f6d616e63652c20696e20776869636820746865206b6e6f776c65646765206f662074686520696e737472756d656e74206f66207468652061726320627920546f73746920636f6e6669726d732069747320646964616374696320747261696e696e6720696e2053616e2050696574726f2061204d616a656c6c61206f66204e61706c65732c20636f6e636c75646564207769746820746865206469706c6f6d6120696e2076696f6c696e2e205468652074776f206f7468657220706965636573206172652074776f202273636865727a6f73207069616e6f222c20506f7570657474652e2054686520547269666f676c696f204d61726365747461207175617369205265616c6520616e642056616c7365206f66206c274164696575202862616c20617520436c617269646765277320486f74656c292c20746865206c617474657220636f6d706f73656420627920546f737469206f6e20746865206f63636173696f6e206f662074686520726563657074696f6e20676976656e20696e207468652066616d6f7573204c6f6e646f6e20686f74656c20746f2063656c65627261746520686973206170706f696e746d656e742061732053697220696e20446563656d62657220313930382e20200a54686520776f726b206f66204a6f617175c3ad6e20506978c3a16e20616e6420616c6c20746865697220636f6c6c65616775657320696e20746865206469736b202864656c6963696f757320746865207265636f76657279206f66207468652064756f73206f6620746865202243616e746920506f706f6c61726920416272757a7a65736922292070726f766964657320757320776974682061207265636f7264696e67207468617420697320616d6f6e6720746865206d6f737420696d706f7274616e74206f6620746865206d617265206d61676e756d22206f662074686520646973636f67726170687920746f737469616e612c206279206c6f76652c20726573706563742c20616e642074686520617274697374696320706572666f726d616e63652e20200a4672616e636573636f2053414e564954414c4520200a4469726563746f72206f662074686520497374697475746f204e617a696f6e616c6520546f737469616e6f206f66204f72746f6e612e202a003214416c6c207269676874732072657365727665642e38004224080110011a195533f3265d5493cd0df464b77ca54e75816d2c8c462d721280250000803f4a1e687474703a2f2f692e696d6775722e636f6d2f6f5074623839432e6a706752005a001a41080110011a30c58a874c8fbb4817e99c5a9560680f1e5a03e285fa03a1c443ec5a3406f88e2c61cf2f1d3c0c5f4f5dab8781929c3d042209766964656f2f6d70342a5c080110031a40883efb4f7c1dcca2d07c12681ef3a183faaab0089f5517018813a4fc7d9dc54da3a6602b582062f0fd270e528209079071083c08a110f6344264b69023800bc52214f940b950b5b3926f7d9bb038f1f4ca7313003491",
		"bYCJbgqhrEF8xTzpJymq3YyNMJDhGubR8V",
		"08011002225e0801100322583056301006072a8648ce3d020106052b8104000a03420004b5b86d78c37f591e2db9432cb822a44aaa4f9b0d08e492cd2843aacb188065e3d244c52a00a91ff58d451eaf38c21f8ef8549b73a83b4c1c3469e2d5d9dc2a11",
		"f940b950b5b3926f7d9bb038f1f4ca7313003491",
	},
	{
		"080110011aab02080112e301080410011a1c43617375616c6c79204578706c61696e65643a20466c697274696e67222c4576656e206d79207368697274206973206d616465206f6620626f79667269656e64206d6174657269616c2e2a1243617375616c6c79204578706c61696e6564322e437265617469766520436f6d6d6f6e73204174747269627574696f6e20342e3020496e7465726e6174696f6e616c38004a4768747470733a2f2f73332e616d617a6f6e6177732e636f6d2f66696c65732e6c6272792e696f2f7468756d626e61696c732f63617375616c6c792d666c697274696e672e6a706752005a001a41080110011a301c70dd6517dafb6a2ba120409ee57d3581dbb95d306f2229bd4d50afcea31b80ac416166d66174f8c8575387183e52772209766964656f2f6d70342a5c080110031a409927966bf8e894ec46277fc46cd77adb99e7c961324b9e7c3f385f2c6533f156905c1482a11d503553794ed0e92c8df2742c091470b6aa6cd7a1b4d81ab82ec022141f30267438257020f08abf452746a48e53a71ad5",
		"bEkt4FyvwxysBh82xhsqqcNc5qhHbuefxT",
		"08011002225e0801100322583056301006072a8648ce3d020106052b8104000a03420004c5f1523643efbfbaaf1bb42c9ea51a7bf37a7e5e6e4abf80d9266214f93839eea3eb725ca184db04b7939b3e4bbfde89257e632726109d8442b8f8388ff5ec1b",
		"1f30267438257020f08abf452746a48e53a71ad5",
	},
	{
		"080110011acf040801128604080410011a1546696e54656b4e65656b7320506f6463617374203622de0246726f6d2074686520617574686f7273206f66207777772e66696e74656b6e65656b732e636f6d2c20537465766520616e642054696d20646973637573732073656c6c696e67206974656d7320616e64207468652070756d702d616e642d64756d702067616d65207768696c652074686579207368617265207468656972207669657773206f6e207468652070726f6a65637473206d656e74696f6e656420696e2074686520706f737473202872657669657720706f737420666f7220746865207765656b292e20546865792064696720696e746f2074686520746f706963206f66204575726f706520616e64206d61726b65747320616e642064726f7020612066657720626f6e7573657320696e2074686520706f646361737420616e642077726170206974207570207769746820612064697363757373696f6e206f6e20626974636f696ee2809973206c696768746e696e67206e6574776f726b2e2a003214416c6c207269676874732072657365727665642e38004224080110031a19552cd5e76fe15aa03bf44770371a5158bd14aa3456327e929125000050404a4468747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f3739343831303130353232353034383036342f687837754b5a494b2e6a706752005a001a42080110011a30256029f4f836dd0b333c15e8d89172c9b1440d6da4a1669365cecf0123d7a3f159bc8b47b38e2489786469f3f794caf1220a617564696f2f6d7065672a5c080110031a40f910fe9fdd08c9b9849ebd840ba0282433a36fb087bc17ea9f1da3facb82eb4aa07c412eae2530e2a80f3219cb6c725d342bcc5bd2402f9d58c5825200c0e1bc22149221451ed1b04238a05f031c00026daa666cc77e",
		"bHTBXR2TWaiWKd5kzM2mibuHrgZMLiq2Kb",
		"08011002225e0801100322583056301006072a8648ce3d020106052b8104000a03420004b2415e7b18b40ed8be54d0bcd19c09e75c43d2594f5844ec1d66bd15778016a828cb50bd72b22f6a47b68df73fb8701ae68cf7f7c12666e2f5469efa0963e5ab",
		"9221451ed1b04238a05f031c00026daa666cc77e",
	},
	{
		"080110011afc02080112b402080410011a2b414a204a5053206f6e204d696e64732e636f6d202d204a6f696e20746865205265766f6c7574696f6e202122b701546865206f6666696369616c20414a204a5053206368616e6e656c206f6e204d494e44532e434f4d2069732072617069646c7920696e6372656173696e6720696e20706f70756c61726974792c2061747472616374696e67206e65772066616e732062792074686520686f75722e204a6f696e20746865207265766f6c7574696f6e20616e6420666f6c6c6f7720414a204a505320686572653a2068747470733a2f2f7777772e6d696e64732e636f6d2f414a5f4a50532a003214416c6c207269676874732072657365727665642e38004a2968747470733a2f2f737065652e63682f414a4a50536d696e64737061676570726f6d6f3f6e65773d3152005a001a41080110011a30f14dceea10ae0f70ac81aa2d32bb55b0e7b2f10a78623b18c0a51b54ec94b901116345c95093b7c0ca84a1e3f4f89bca2209766964656f2f6d70342a5c080110031a40589272fb4d4580cf2716894e3049abdb9a2839c6d8df9b27da4de73828156ab24ab6e877eb66e78899005f11449df87f2aba9a237deec2319cfbbdeaf25fd729221479f6085752cee02b1cf992e4d5a35c7e849880ec",
		"bbZ2C5hxDjfBm6Wn1jVjKfuxj42wMcCWER",
		"08011002225e0801100322583056301006072a8648ce3d020106052b8104000a03420004ccfccf2af2f849419f795a902261fffb62127c1f9a5c6e5da93eb230287ed7556a6508ecad1fe6e44e4ef01c779ebadfe885d8f24d85aef8fd516ab73b9e63ce",
		"79f6085752cee02b1cf992e4d5a35c7e849880ec",
	},
}

var fail = []claimCertTest{
	{
		"080110011abe0108011277080410011a10676f6f6d616c6c696e672073746f726d2211636c6f756473206e6561722070657274682a147065727468207765617468657220627572656175322e437265617469766520436f6d6d6f6e73204174747269627574696f6e20342e3020496e7465726e6174696f6e616c38004a0052005a001a41080110011a30bafc8dcaecfb85552dd11ff503aed48593e15749aaa4135f7b7b3eb38e87a093fd94758076e659ea89627479f6874ad32209766964656f2f6d70342a5c080110031a40365108cd362b1bd2692935bb93d4272e3c855b0166b960c9054f2ea9d163b5da6a32ab37dc4aaaddc108337a1aec34770cff51efb913b558a2d7997cc7f7620b2214000278a3339c1dbcd26b825f0ec7b8420b0e7fdb",
		"bZUcHKWkKJQq6NLHY27om2YEehTsmXfB6m",
		"08011002225e0801100322583056301006072a8648ce3d020106052b8104000a03420004329169150ec64661c122b511009f3e2b16c614a096b44a58f8ec0d1229905f78c92fdc183c022e49b1886fc2c2a105382e0131334eb6f84191c0c9a0a3c3bdb8",
		"000278a3339c1dbcd26b825f0ec7b8420b0e7fdb",
	},
	{
		"080110011a970e080112c90d080410011a1454686520446f6d61696e204e616d652047616d6522cc0c54686520446f6d61696e204e616d652047616d6520697320616e2065426f6f6b207468617420636f6e7461696e732075736566756c20696e666f726d6174696f6e2072656c6174696e6720746f20696e76657374696e6720616e642074726164696e6720646f6d61696e206e616d65732e205468697320626f6f6b2077696c6c20746561636820796f752065766572797468696e6720796f75206e65656420746f206b6e6f772061626f757420646f6d61696e206e616d65732e200a0a54686520746f7069637320636f766572656420696e207468697320636f6d706c6574652067756964652061726520617320666f6c6c6f77733b20496e74726f64756374696f6e20746f20627579696e6720616e642073656c6c696e67206f6620646f6d61696e206e616d65732c20486f7720746f207069636b2068696768207175616c697479207072656d69756d20646f6d61696e206e616d65732c20486f7720746f2062757920646f6d61696e206e616d65732c20486f7720746f2073656c6c20646f6d61696e206e616d65732c20446f6d61696e2042726f6b6572732c2043757272656e74207472656e647320696e20746865206d61726b65742c20446966666572656e7420544c4427732c20616e6420446f6d61696e20666c697070696e672e2054686520626561757479206f662074686973206e6f6e2d66696374696f6e20697320697473272073696d706c696369747920616e6420737465702062792073746570206578706c616e6174696f6e732e0a0a49742077696c6c2073686f7720796f7520686f7720746f206d616b65206d6f6e657920627920696e76657374696e6720696e206120646f6d61696e206e616d652e2054686520626f6f6b20616c736f20737570706c6965732061207765616c7468206f6620696e666f726d6174696f6e207468617420776f756c642074616b6520796f75206461797320746f206761746865722066726f6d20616e20696e7465726e6574207365617263682e2054686520696e666f726d6174696f6e20686173206265656e20636f6d70696c65642c2065646974656420616e642066696c746572656420746f2070726f647563652061206e65617420616e6420736f70686973746963617465642065426f6f6b2e2054686520626f6f6b20636f6e7461696e7320616c6c20746865206a6172676f6e2c207465726d696e6f6c6f677920616e6420276c696e676f272072656c6174696e6720746f207468697320686967686c792070726f66697461626c65206e696368652e20546865206669727374207374657020746f20616e797468696e6720696e206c6966652069732061747461696e696e6720612066756c6c20756e6465727374616e64696e67206f66207768617420796f752061726520646f696e672e205468697320626f6f6b206973206a75737420746861742e20497420737570706c6965732061207374726f6e6720666f756e646174696f6e2066726f6d20776869636820796f75206d61792067726f7720616e6420646576656c6f702e20546865726520617265206d616e792075736566756c207469707320616e64206164766963652070726f766964656420627920736f6d6520657870657269656e6365642070656f706c652077697468696e20746865206669656c642e20546869732077696c6c20656e73757265207468617420796f7520646f206e6f74206d616b6520746865206e6f76696365206d697374616b65732074686174206d616e79206e657762696573206d616b652e20596f752077696c6c2061747461696e2073686f72746375747320616e6420747269636b7320746f2063686f6f736520746865206265737420646f6d61696e206e616d65732e205468697320626f6f6b2069732061206d757374207265616420666f7220616e7920626567696e6e6572732061732077656c6c20617320746865206d6173746572732c2061732069742070726f766964657320616e616c79736973206f66207468652063757272656e74207472656e647320696e2074686520646f6d61696e206e616d65206d61726b65742e200a0a416c6c20696e20616c6c2074686520626f6f6b2069732067756172616e7465656420746f207361766520796f752074696d6520616e64206d6f6e65792e20416674657220616c6c20612073696d706c6520726561642063616e206f6e6c792062656e6566697420796f752e2a00322e437265617469766520436f6d6d6f6e73204174747269627574696f6e20342e3020496e7465726e6174696f6e616c38004224080110031a1955abcd23bb4f84c5d01990512c21a5fdb24035f7a8f105ca3e25a4707d3f4a0052005a001a47080110011a301ff9f9f1f7b147bb0ef27a27f5507ee1caacebc30bca9a0c38de42408bf3786d974b167139cc49d67be20e54c72f5d25220f6170706c69636174696f6e2f7064662a5c080110031a4093d452f4efdd06593d727d72ddcfaf741ef4352cdb15e1ec3ecd8731b4d186dc78d9d9166b7f168a6219ef57f18f9e1e65e0d79ce2012203d2874f94326be41d2214547b2ad7794f4188083180d09d9904d8c14967c7",
		"bXzNjyEGNA8PZMrQpoiCcML5ZpiDrrkE1B",
		"08011002225e0801100322583056301006072a8648ce3d020106052b8104000a034200042d471bea04c7a21e1aacdedd6262f6931c8f4a1e16ed0b67c51b9639d4efa095de9525e9594304d3b070ae52cb0941b047109e45decbcbc46904e5f14a8ea7ba",
		"547b2ad7794f4188083180d09d9904d8c14967c7",
	},
}

func TestV2Validation(t *testing.T) {
	firstTxID := "e8168121dac295625b5b8de880f13f5d08d7974ba86108957ba71f17ed7b4e06"
	channelClaimID := "94ef9a76965c239eb248f7e448252df8da868116"
	stream, err := claim.DecodeClaimHex("01168186daf82d2548e4f748b29e235c96769aef9448dc2bf20843de50292b7e2b57e4b6621bbfd37954bd0ce3a8053de08335125742f4deee351f44d36bbf3d0bbf8b4595139260abb4075cee31370e8c57a19f2d0a00", global.BlockChainName)
	if err != nil {
		t.Error(err)
	}
	channel, err := claim.DecodeClaimHex("00128b010a583056301006072a8648ce3d020106052b8104000a03420004e525fef8bf20cd100e8ec6818aeb56ddd59c79467670a3b53d0b983379cd49b2cb8c514d895bfeb304257e9ca0fc839dc44fcc4db4f3e7652f4525965e5e0abc1a1768747470733a2f2f686f6d657061676575726c2e636f6d22162a1468747470733a2f2f636f76657275726c2e636f6d", global.BlockChainName)
	if err != nil {
		t.Error(err)
	}

	passed, err := stream.ValidateClaimSignature(channel, firstTxID, channelClaimID, global.BlockChainName)
	if err != nil {
		t.Error(err)
	}
	if !passed {
		t.Error("Signed Claim, did not match the Certificate Claim")
	}

}

func TestCertifyClaim(t *testing.T) {
	for _, testCase := range pass {
		signedHelper, err := claim.DecodeClaimHex(testCase.signedClaimHex, global.BlockChainName)
		if err != nil {
			t.Error(err)
		}
		certHelper, err := claim.DecodeClaimHex(testCase.certClaimHex, global.BlockChainName)
		if err != nil {
			t.Error(err)
		}

		passed, err := signedHelper.ValidateClaimSignature(certHelper, testCase.signedClaimAddress, testCase.certClaimID, global.BlockChainName)
		if err != nil {
			t.Error(err)
		}
		if !passed {
			t.Error("Signed Claim, did not match the Certificate Claim")
		}
	}

	for _, testCase := range fail {
		signedHelper, err := claim.DecodeClaimHex(testCase.signedClaimHex, global.BlockChainName)
		if err != nil {
			t.Error(err)
		}
		certHelper, err := claim.DecodeClaimHex(testCase.certClaimHex, global.BlockChainName)
		if err != nil {
			t.Error(err)
		}

		passed, err := signedHelper.ValidateClaimSignature(certHelper, testCase.signedClaimAddress, testCase.certClaimID, global.BlockChainName)
		if err != nil {
			t.Error(err)
		}
		if passed {
			t.Error("Signed Claim, should not match the Certificate Claim")
		}
	}

}
